% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/deviation.R
\name{deviation.last}
\alias{deviation.last}
\title{Deviation Last Contrast Coding}
\usage{
deviation.last(n, intercept = FALSE, contrasts = TRUE, sparse = FALSE)
}
\arguments{
\item{n}{An integer specifying the number of levels, or a character vector specifying the level names.}

\item{intercept}{Logical. If \code{TRUE}, includes a column for the intercept.}

\item{contrasts}{Logical. If \code{TRUE}, returns contrast codes; if \code{FALSE}, returns an identity matrix.}

\item{sparse}{Logical. If \code{TRUE}, returns the matrix in sparse form using \code{.Diag()}.}
}
\value{
A contrast matrix of size \code{n x (n - 1)} (or \code{n x n} if \code{contrasts = FALSE}),
optionally in sparse format. If \code{intercept = TRUE}, a column of 1s is prepended to the matrix.
}
\description{
Generates deviation contrast coding with the last level as the reference.
This contrast compares each level to the overall mean deviation from the last level.
This coding is equivalent to R's base \code{contr.sum}.
}
\details{
\strong{Contrast Type}: Deviation (Last)\cr
\strong{R Equivalent}: \code{contr.sum}\cr
\strong{SPSS Equivalent}: deviation\cr
\strong{MR Equivalent}: effect\cr
\strong{codingMatrices Equivalent}: deviation\cr
}
\note{
This function implements the deviation contrast coding similar to R base \code{contr.sum}.
It is adapted for use with sparse matrices and extended functionality.
}
